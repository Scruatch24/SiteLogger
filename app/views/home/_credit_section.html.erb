<div id="creditGroup" class="hidden dynamic-section group relative transition-all duration-300 !mt-12" data-protected="credit">
  <!-- New External Header -->
  <div class="flex items-center mb-2 px-1">
    <svg class="h-4 w-4 text-red-600 mr-2">
      <use xlink:href="#icon-credit"></use>
    </svg>
    <span class="text-base font-black text-red-600 uppercase tracking-widest"><%= t('credit') %></span>
  </div>

  <!-- The Content Box -->
  <div id="creditContent" class="border-2 border-dashed border-red-200 rounded-2xl bg-red-50/30 relative transition-all duration-300 px-4 pt-4 pb-8">
  
  <!-- Remove Button (Top Right of Box) -->
   <button type="button" onclick="removeCreditSection()" 
           class="absolute -top-3.5 -right-3.5 bg-black text-white w-7 h-7 rounded-full flex items-center justify-center shadow-[1px_1px_0px_0px_rgba(0,0,0,0.3)] btn-remove-section-hover transition-colors z-20" title="Remove Credit">
     <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
       <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
     </svg>
   </button>

    
    <!-- Credit Items Container -->
    <div id="creditItemsContainer" class="pt-2">
       <!-- Initial credit item row -->
       <div class="flex flex-col gap-2 w-full credit-item-row animate-in fade-in slide-in-from-left-2 duration-300 border-t-2 border-dashed border-red-200 pt-6 mt-6 first:border-0 first:pt-0 first:mt-0">
          <!-- Amount Input Section -->
          <div class="space-y-1 relative w-1/2">
            <label class="block text-[9px] font-bold text-gray-500 uppercase ml-1">
              <%= t('amount').upcase %>
            </label>
            <div class="flex items-center border-2 border-black rounded-xl bg-white shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] relative h-[52px]">
                <span class="flex items-center justify-center bg-red-600 text-white font-black border-2 border-black rounded-lg h-6 w-6 ml-2 shrink-0 select-none text-[10px] credit-unit-indicator"><%= currencies_data.find { |c| c[:c] == (@profile.currency.presence || "USD") }[:s] %></span>
                <input type="number" step="0.01" 
                       class="credit-amount-input bg-transparent border-none py-3 pl-2 pr-2 font-black text-black focus:ring-0 outline-none text-left min-w-0 text-sm placeholder:text-gray-300 w-full flex-1"
                       placeholder="<%= t('amount') %>"
                       oninput="updateTotalsSummary()">
            </div>
          </div>

          <!-- Reason Input Section + Remove -->
          <div class="flex items-center gap-2 w-full">
            <div class="flex flex-1 items-center border-2 border-black rounded-xl bg-white shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] min-w-0 main-item-box transition-colors relative h-[52px]">
              <input type="text" class="flex-1 bg-transparent border-none text-sm font-bold text-black focus:ring-0 py-3 px-4 credit-reason-input placeholder:text-gray-300 min-w-0 rounded-xl"
                     value="<%= t('courtesy_credit') %>"
                     placeholder="<%= t('reason_for_credit') %>">
            </div>
            
            <button type="button" onclick="this.closest('.credit-item-row').remove(); updateTotalsSummary();" class="remove-credit-btn w-6 h-10 flex items-center justify-center text-gray-300 hover:text-red-500 transition-colors font-bold text-xl flex-shrink-0">Ã—</button>
          </div>
       </div>
       
       <!-- Add Item Button at Bottom Center -->
       <div class="flex justify-center mt-8 section-add-btn-container">
          <button type="button" onclick="addCreditItem('creditItemsContainer')" 
                  class="bg-red-600 text-white w-8 h-8 rounded-full flex items-center justify-center shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] active:scale-95 hover:bg-red-700 transition-all" title="Add Credit Item">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
            </svg>
          </button>
       </div>
    </div>
  </div>
</div>
