<% is_active = ->(path) { request.path == path ? 'site-nav-active' : '' } %>

<nav class="site-header" data-nosnippet>
  <div class="site-header-inner">
    <!-- Logo -->
    <a href="/" class="site-logo">
      <div class="site-logo-icon">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 7h6" />
        </svg>
      </div>
      <span class="site-logo-text">TALK<span class="text-orange-600">INVOICE</span></span>
    </a>

    <!-- Desktop Nav Links -->
    <div class="site-nav-links">
      <%= link_to root_path, class: "site-nav-link #{is_active.call('/')}" do %>
        <%= t('nav.home') %>
      <% end %>
      <%= link_to history_path, class: "site-nav-link #{is_active.call('/history')}" do %>
        <%= t('nav.history') %>
      <% end %>
      <%= link_to profile_path, class: "site-nav-link #{is_active.call('/profile')}" do %>
        <%= t('nav.profile') %>
      <% end %>
      <%= link_to settings_path, class: "site-nav-link #{is_active.call('/settings')}" do %>
        <%= t('nav.settings') %>
      <% end %>
      <%= link_to pricing_path, class: "site-nav-link site-nav-pricing #{is_active.call('/pricing')}" do %>
        <svg xmlns="http://www.w3.org/2000/svg" class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.562.562 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.562.562 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
        </svg>
        <%= t('nav.pricing') %>
      <% end %>
    </div>

    <!-- Desktop Auth -->
    <div class="site-auth-links">
      <% if user_signed_in? %>
        <button type="button" onclick="window.showLogoutModal()" class="site-auth-btn site-auth-logout">
          <%= t('nav.log_out') %>
        </button>
      <% else %>
        <%= link_to new_user_session_path, class: "site-auth-btn site-auth-signin" do %>
          <%= t('nav.sign_in') %>
        <% end %>
        <%= link_to new_user_registration_path, class: "site-auth-btn site-auth-signup" do %>
          <%= t('nav.sign_up') %>
        <% end %>
      <% end %>
    </div>

    <!-- Mobile Quick Nav (Home + History always visible) -->
    <div class="site-mobile-quick-nav">
      <%= link_to root_path, class: "site-mobile-quick-link #{is_active.call('/')}" do %>
        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
        <%= t('nav.home') %>
      <% end %>
      <%= link_to history_path, class: "site-mobile-quick-link #{is_active.call('/history')}" do %>
        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        <%= t('nav.history') %>
      <% end %>
    </div>

    <!-- Mobile Hamburger -->
    <button type="button" class="site-hamburger" onclick="toggleSiteMenu()" aria-label="<%= t('nav.menu') %>">
      <span class="hamburger-line hamburger-line-1"></span>
      <span class="hamburger-line hamburger-line-2"></span>
      <span class="hamburger-line hamburger-line-3"></span>
    </button>
  </div>

  <!-- Mobile Menu (hamburger dropdown â€” Profile, Settings, Pricing, Auth) -->
  <div class="site-mobile-menu" id="siteMenuMobile">
    <div class="site-mobile-nav">
      <%= link_to profile_path, class: "site-mobile-link #{is_active.call('/profile')}" do %>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
        <%= t('nav.profile') %>
      <% end %>
      <%= link_to settings_path, class: "site-mobile-link #{is_active.call('/settings')}" do %>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
        <%= t('nav.settings') %>
      <% end %>
      <%= link_to pricing_path, class: "site-mobile-link site-mobile-pricing #{is_active.call('/pricing')}" do %>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.562.562 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.562.562 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z"/></svg>
        <%= t('nav.pricing') %>
      <% end %>
    </div>
    <div class="site-mobile-auth">
      <% if user_signed_in? %>
        <button type="button" onclick="window.showLogoutModal()" class="site-mobile-auth-btn site-auth-logout">
          <%= t('nav.log_out') %>
        </button>
      <% else %>
        <%= link_to new_user_session_path, class: "site-mobile-auth-btn site-auth-signin" do %>
          <%= t('nav.sign_in') %>
        <% end %>
        <%= link_to new_user_registration_path, class: "site-mobile-auth-btn site-auth-signup" do %>
          <%= t('nav.sign_up') %>
        <% end %>
      <% end %>
    </div>
  </div>
</nav>

<script>
  function toggleSiteMenu() {
    const menu = document.getElementById('siteMenuMobile');
    const btn = document.querySelector('.site-hamburger');
    menu.classList.toggle('open');
    btn.classList.toggle('open');
  }
</script>
